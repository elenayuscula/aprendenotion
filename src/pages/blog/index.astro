---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .sort((a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime());
---

<BaseLayout
  title="Blog — Aprende Notion"
  description="Artículos, tutoriales y recursos sobre Notion. Aprende trucos, descubre plantillas y domina la herramienta de productividad más versátil."
>
  <div class="page-wrapper page-wrapper--wide">
    <!-- Blog hero -->
    <section class="blog-hero">
      <h1 class="blog-hero__title">Blog</h1>
      <p class="blog-hero__subtitle">
        Artículos, tutoriales y recursos para sacarle el máximo partido a Notion y mejorar tu productividad.
      </p>
    </section>

    <!-- Blog post grid -->
    <section class="blog-grid" aria-label="Artículos del blog">
      {posts.map((post) => (
        <a href={`/blog/${post.id}`} class="blog-card">
          <div class="blog-card__emoji" aria-hidden="true">{post.data.emoji}</div>
          <div class="blog-card__content">
            <div class="blog-card__meta">
              <span class="blog-card__category">{post.data.category}</span>
              <span class="blog-card__separator">·</span>
              <time datetime={post.data.publishDate}>{new Date(post.data.publishDate).toLocaleDateString('es-ES', { year: 'numeric', month: 'short', day: 'numeric' })}</time>
            </div>
            <h2 class="blog-card__title">{post.data.title}</h2>
            <p class="blog-card__description">{post.data.description}</p>
            <span class="blog-card__reading-time">{post.data.readingTime}</span>
          </div>
        </a>
      ))}
    </section>
  </div>

  <!-- Blog structured data -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Blog",
    "name": "Blog — Aprende Notion",
    "description": "Artículos, tutoriales y recursos sobre Notion.",
    "url": "https://aprendenotion.com/blog",
    "inLanguage": "es",
    "author": {
      "@type": "Person",
      "name": "Elena Madrigal",
      "url": "https://elenamadrigal.com"
    }
  })} />
</BaseLayout>
